



Network Working Group                                            X. Geng
Internet-Draft                                                   M. Chen
Intended status: Standards Track                     Huawei Technologies
Expires: May 20, 2021                                            Y. Ryoo
                                                                    ETRI
                                                                D. Fedyk
                                                 LabN Consulting, L.L.C.
                                                               R. Rahman
                                                              Individual
                                                                   Z. Li
                                                            China Mobile
                                                       November 16, 2020


       Deterministic Networking (DetNet) Configuration YANG Model
                       draft-ietf-detnet-yang-09

Abstract

   This document contains the specification for Deterministic Networking
   flow configuration YANG Model.  The model allows for provisioning of
   end-to-end DetNet service along the path without dependency on any
   signaling protocol.

   The YANG module defined in this document conforms to the Network
   Management Datastore Architecture (NMDA).

Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."




Geng, et al.              Expires May 20, 2021                  [Page 1]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


   This Internet-Draft will expire on May 20, 2021.

Copyright Notice

   Copyright (c) 2020 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Terminologies . . . . . . . . . . . . . . . . . . . . . . . .   3
   3.  DetNet Configuration Module . . . . . . . . . . . . . . . . .   3
     3.1.  DetNet Appliction Flow Configuration Attributes . . . . .   3
     3.2.  DetNet Service Sub-layer Configuration Attributes . . . .   3
     3.3.  DetNet Forwarding Sub-layer Configuration Attributes  . .   4
   4.  DetNet Flow Aggregation . . . . . . . . . . . . . . . . . . .   4
   5.  DetNet YANG Structure Considerations  . . . . . . . . . . . .   5
   6.  DetNet Configuration YANG Structures  . . . . . . . . . . . .   6
   7.  DetNet Configuration YANG Model . . . . . . . . . . . . . . .  14
   8.  Open Issues . . . . . . . . . . . . . . . . . . . . . . . . .  40
   9.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  40
   10. Security Considerations . . . . . . . . . . . . . . . . . . .  40
   11. Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  40
   12. References  . . . . . . . . . . . . . . . . . . . . . . . . .  40
     12.1.  Normative References . . . . . . . . . . . . . . . . . .  40
     12.2.  Informative References . . . . . . . . . . . . . . . . .  41
   Appendix A.  Examples . . . . . . . . . . . . . . . . . . . . . .  41
     A.1.  Example JSON Configuration  . . . . . . . . . . . . . . .  41
     A.2.  Example XML Config: Aggregation using a Forwarding
           Sublayer  . . . . . . . . . . . . . . . . . . . . . . . .  45
     A.3.  Example JSON Service Aggregation Configuration  . . . . .  50
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  55

1.  Introduction

   DetNet (Deterministic Networking) provides a capability to carry
   specified unicast or multicast data flows for real-time applications
   with extremely low packet loss rates and assured maximum end-to-end



Geng, et al.              Expires May 20, 2021                  [Page 2]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


   delivery latency.  A description of the general background and
   concepts of DetNet can be found in [RFC8655].

   This document defines a YANG model for DetNet based on YANG data
   types and modeling language defined in [RFC6991] and [RFC7950].
   DetNet service, which is designed for describing the characteristics
   of services being provided for application flows over a network, and
   DetNet configuration, which is designed for DetNet flow path
   establishment, flow status reporting, and DetNet functions
   configuration in order to achieve end-to-end bounded latency and zero
   congestion loss, are both included in this document.

2.  Terminologies

   This documents uses the terminologies defined in [RFC8655].

3.  DetNet Configuration Module

   DetNet configuration module includes DetNet App-flow configuration,
   DetNet Service Sub-layer configuration, and DetNet Forwarding Sub-
   layer configuration.  The corresponding attributes used in different
   sub-layers are defined in Section 3.1, 3.2, 3.3 respectively.

3.1.  DetNet Appliction Flow Configuration Attributes

   DetNet application flow is responsible for mapping between
   application flows and DetNet flows at the edge node(egress/ingress
   node).  Where the application flows can be either layer 2 or layer 3
   flows.  To map a flow at the User Network Interface (UNI), the
   corresponding attributes are defined in
   [I-D.ietf-detnet-flow-information-model].

3.2.  DetNet Service Sub-layer Configuration Attributes

   DetNet service functions, e.g., DetNet tunnel initialization/
   termination and service protection, are provided in DetNet service
   sub-layer.  To support these functions, the following service
   attributes need to be configured:

   o  DetNet flow identification

   o  Service function indication, indicates which service function will
      be invoked at a DetNet edge, relay node or end station.  (DetNet
      tunnel initialization or termination are default functions in
      DetNet service layer, so there is no need for explicit
      indication).  The corresponding arguments for service functions
      also needs to be defined.




Geng, et al.              Expires May 20, 2021                  [Page 3]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


3.3.  DetNet Forwarding Sub-layer Configuration Attributes

   As defined in [RFC8655], DetNet forwarding sub-layer optionally
   provides congestion protection for DetNet flows over paths provided
   by the underlying network.  Explicit route is another mechanism that
   is used by DetNet to avoid temporary interruptions caused by the
   convergence of routing or bridging protocols, and it is also
   implemented at the DetNet forwarding sub-layer.

   To support congestion protection and explicit route, the following
   transport layer related attributes are necessary:

   o  Traffic Specification, refers to Section 7.2 of
      [I-D.ietf-detnet-flow-information-model].  It may used for
      resource reservation, flow shaping, filtering and policing.

   o  Explicit path, existing explicit route mechanisms can be reused.
      For example, if Segment Routing (SR) tunnel is used as the
      transport tunnel, the configuration is mainly at the ingress node
      of the transport layer; if the static MPLS tunnel is used as the
      transport tunnel, the configurations need to be at every transit
      node along the path; for pure IP based transport tunnel, it's
      similar to the static MPLS case.

4.  DetNet Flow Aggregation

   DetNet provides the capability of flow aggregation to improve
   scaleability of DetNet data, management and control planes.
   Aggregated flows can be viewed by the some DetNet nodes as individual
   DetNet flows.  When aggregating DetNet flows, the flows should be
   compatible: if bandwidth reservations are used, the reservation
   should be a reasonable representation of the individual reservations;
   if maximum delay bounds are used, the system should ensure that the
   aggregate does not exceed the delay bounds of the individual flows.

   The DetNet YANG model defined in this document supports DetNet flow
   aggregation with the following functions:

   o  Aggregation flow encapsulation/decapsulation/identification

   o  Mapping individual DetNet flows to an aggregated flow

   o  Changing traffic specification parameters for aggregated flow

   The following cases of DetNet aggregation are supported:






Geng, et al.              Expires May 20, 2021                  [Page 4]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


   o  aggregate data flows into an application which is then mapped to a
      service sub-layer at the ingress node.  Note the data flows may be
      other DetNet flows.

   o  map each DetNet application to a single service sub-layer and
      allowing the aggregation of multiple applications at the ingress
      node, and vice versa for de-aggregation.  A classifier may be
      required to de-aggregate the respective applications.

   o  map each DetNet application uniquely to a single service sub-layer
      where those sub-layers may be encapsulated as a single service
      sub-layer and hence aggregating the applications at the ingress
      node, and vice versa for de-aggregation.  In this case, the
      service sub-layer identifier may be sufficient to identify the
      application.  A classifier may be required to de-aggregate the
      service sub-layers.

   o  aggregate DetNet service sub-layers into an aggregated flow by
      using the same forwarding sub-layer at ingress node or relay node,
      and vice versa for de-aggregation.

   o  aggregate DetNet flows with different forwarding sub-layer into an
      aggregated flow by using the same forwarding sub-layer at transit
      node, and vice versa for de-aggregation.

   Traffic requirements and traffic specification may be tracked for
   individual or aggregate flows but reserving resources and tracking
   the services in the aggregated flow is out of scope.

5.  DetNet YANG Structure Considerations

   The picture shows that the general structure of the DetNet YANG
   Model:

                     +-----------+
                     |ietf-detnet|
                     +-----+-----+
                           |
             +-------------+---------------+
             |             |               |
       +-----+-----+ +-----+-----+ +-------+------+
       | App Flows | |service s-l| |forwarding s-l|
       +-----------+ +-----------+ +--------------+

   There are three instances in DetNet YANG Model: App-flow instance,
   service sub-layer instance and forwarding sub-layer instance,
   respectively corresponding to four parts of DetNet functions defined
   in section 3.



Geng, et al.              Expires May 20, 2021                  [Page 5]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


6.  DetNet Configuration YANG Structures

 module: ietf-detnet
   +--rw detnet
      +--rw traffic-profile* [profile-name]
      |  +--rw profile-name                   string
      |  +--rw traffic-requirements
      |  |  +--rw min-bandwidth?                    uint64
      |  |  +--rw max-latency?                      uint32
      |  |  +--rw max-latency-variation?            uint32
      |  |  +--rw max-loss?                         uint32
      |  |  +--rw max-consecutive-loss-tolerance?   uint32
      |  |  +--rw max-misordering?                  uint32
      |  +--rw traffic-specification
      |  |  +--rw interval?                       uint32
      |  |  +--rw max-packets-per-interval?       uint32
      |  |  +--rw max-payload-size?               uint32
      |  |  +--rw average-packets-per-interval?   uint32
      |  |  +--rw average-payload-size?           uint32
      |  +--ro member-applications*           app-flow-ref
      |  +--ro member-services*               service-sub-layer-ref
      |  +--ro member-forwarding-sublayers*   forwarding-sub-layer-ref
      +--rw app-flows
      |  +--rw app-flow* [name]
      |     +--rw name                        string
      |     +--rw app-flow-bidir-congruent?   boolean
      |     +--ro outgoing-service?           service-sub-layer-ref
      |     +--ro incoming-service?           service-sub-layer-ref
      |     +--rw traffic-profile?            traffic-profile-ref
      |     +--rw ingress
      |     |  +--rw name?                            string
      |     |  +--ro app-flow-status?                 identityref
      |     |  +--rw interface?                       if:interface-ref
      |     |  +--rw (data-flow-type)?
      |     |     +--:(tsn-app-flow)
      |     |     |  +--rw source-mac-address?        yang:mac-address
      |     |     |  +--rw destination-mac-address?   yang:mac-address
      |     |     |  +--rw ethertype?
      |     |     |  |       ethertypes:ethertype
      |     |     |  +--rw vlan-id?
      |     |     |  |       dot1q-types:vlanid
      |     |     |  +--rw pcp?                       uint8
      |     |     +--:(ip-app-flow)
      |     |     |  +--rw src-ip-prefix?             inet:ip-prefix
      |     |     |  +--rw dest-ip-prefix?            inet:ip-prefix
      |     |     |  +--rw next-header?               uint8
      |     |     |  +--rw traffic-class?             uint8
      |     |     |  +--rw flow-label?



Geng, et al.              Expires May 20, 2021                  [Page 6]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


      |     |     |  |       inet:ipv6-flow-label
      |     |     |  +--rw source-port
      |     |     |  |  +--rw (port-range-or-operator)?
      |     |     |  |     +--:(range)
      |     |     |  |     |  +--rw lower-port    inet:port-number
      |     |     |  |     |  +--rw upper-port    inet:port-number
      |     |     |  |     +--:(operator)
      |     |     |  |        +--rw operator?     operator
      |     |     |  |        +--rw port          inet:port-number
      |     |     |  +--rw destination-port
      |     |     |  |  +--rw (port-range-or-operator)?
      |     |     |  |     +--:(range)
      |     |     |  |     |  +--rw lower-port    inet:port-number
      |     |     |  |     |  +--rw upper-port    inet:port-number
      |     |     |  |     +--:(operator)
      |     |     |  |        +--rw operator?     operator
      |     |     |  |        +--rw port          inet:port-number
      |     |     |  +--rw ipsec-spi?                 ipsec-spi
      |     |     +--:(mpls-app-flow)
      |     |        +--rw (label-space)?
      |     |           +--:(context-label-space)
      |     |           |  +--rw mpls-label-stack
      |     |           |     +--rw entry* [id]
      |     |           |        +--rw id               uint8
      |     |           |        +--rw label?
      |     |           |        |       rt-types:mpls-label
      |     |           |        +--rw ttl?             uint8
      |     |           |        +--rw traffic-class?   uint8
      |     |           +--:(platform-label-space)
      |     |              +--rw label?
      |     |                      rt-types:mpls-label
      |     +--rw egress
      |        +--rw name?             string
      |        +--rw (application-type)?
      |           +--:(Ethernet)
      |           |  +--rw Ethernet
      |           |     +--rw Ethernet-place-holder?   string
      |           +--:(ip-mpls)
      |              +--rw ip-mpls
      |                 +--rw (next-hop-options)
      |                    +--:(simple-next-hop)
      |                    |  +--rw outgoing-interface?
      |                    |  |       if:interface-ref
      |                    |  +--rw (flow-type)?
      |                    |     +--:(ip)
      |                    |     |  +--rw next-hop-address?
      |                    |     |          inet:ip-address
      |                    |     +--:(mpls)



Geng, et al.              Expires May 20, 2021                  [Page 7]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


      |                    |        +--rw mpls-label-stack
      |                    |           +--rw entry* [id]
      |                    |              +--rw id               uint8
      |                    |              +--rw label?
      |                    |              |       rt-types:mpls-label
      |                    |              +--rw ttl?             uint8
      |                    |              +--rw traffic-class?   uint8
      |                    +--:(next-hop-list)
      |                       +--rw next-hop-list
      |                          +--rw next-hop* [hop-index]
      |                             +--rw hop-index
      |                             |       uint8
      |                             +--rw outgoing-interface?
      |                             |       if:interface-ref
      |                             +--rw (flow-type)?
      |                                +--:(ip)
      |                                |  +--rw next-hop-address?
      |                                |          inet:ip-address
      |                                +--:(mpls)
      |                                   +--rw mpls-label-stack
      |                                      +--rw entry* [id]
      |                                         +--rw id
      |                                         |       uint8
      |                                         +--rw label?
      |                                         |       rt-types:
      |                                         |       mpls-label
      |                                         +--rw ttl?
      |                                         |       uint8
      |                                         +--rw traffic-class?
      |                                                 uint8
      +--rw service-sub-layer
      |  +--rw service-sub-layer-list* [name]
      |     +--rw name                      string
      |     +--rw service-rank?             uint8
      |     +--rw traffic-profile?          traffic-profile-ref
      |     +--rw service-protection
      |     |  +--rw service-protection-type?   service-protection-type
      |     |  +--rw sequence-number-length?    sequence-number-field
      |     +--rw service-operation-type?   service-operation-type
      |     +--rw incoming-type
      |     |  +--rw (incoming-type)
      |     |     +--:(app-flow)
      |     |     |  +--rw app-flow
      |     |     |     +--rw flow-list*   app-flow-ref
      |     |     +--:(service)
      |     |     |  +--rw service
      |     |     |     +--rw service-sub-layer*
      |     |     |             service-sub-layer-ref



Geng, et al.              Expires May 20, 2021                  [Page 8]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


      |     |     +--:(forwarding)
      |     |     |  +--rw forwarding
      |     |     |     +--rw forwarding-sub-layer*
      |     |     |             forwarding-sub-layer-ref
      |     |     +--:(service-identification)
      |     |        +--rw service-identification
      |     |           +--rw (detnet-flow-type)?
      |     |              +--:(ip-detnet-flow)
      |     |              |  +--rw src-ip-prefix?
      |     |              |  |       inet:ip-prefix
      |     |              |  +--rw dest-ip-prefix?
      |     |              |  |       inet:ip-prefix
      |     |              |  +--rw next-header?              uint8
      |     |              |  +--rw traffic-class?            uint8
      |     |              |  +--rw flow-label?
      |     |              |  |       inet:ipv6-flow-label
      |     |              |  +--rw source-port
      |     |              |  |  +--rw (port-range-or-operator)?
      |     |              |  |     +--:(range)
      |     |              |  |     |  +--rw lower-port
      |     |              |  |     |  |       inet:port-number
      |     |              |  |     |  +--rw upper-port
      |     |              |  |     |          inet:port-number
      |     |              |  |     +--:(operator)
      |     |              |  |        +--rw operator?     operator
      |     |              |  |        +--rw port
      |     |              |  |                inet:port-number
      |     |              |  +--rw destination-port
      |     |              |  |  +--rw (port-range-or-operator)?
      |     |              |  |     +--:(range)
      |     |              |  |     |  +--rw lower-port
      |     |              |  |     |  |       inet:port-number
      |     |              |  |     |  +--rw upper-port
      |     |              |  |     |          inet:port-number
      |     |              |  |     +--:(operator)
      |     |              |  |        +--rw operator?     operator
      |     |              |  |        +--rw port
      |     |              |  |                inet:port-number
      |     |              |  +--rw ipsec-spi?                ipsec-spi
      |     |              +--:(mpls-detnet-flow)
      |     |                 +--rw (label-space)?
      |     |                    +--:(context-label-space)
      |     |                    |  +--rw mpls-label-stack
      |     |                    |     +--rw entry* [id]
      |     |                    |        +--rw id               uint8
      |     |                    |        +--rw label?
      |     |                    |        |       rt-types:mpls-label
      |     |                    |        +--rw ttl?             uint8



Geng, et al.              Expires May 20, 2021                  [Page 9]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


      |     |                    |        +--rw traffic-class?   uint8
      |     |                    +--:(platform-label-space)
      |     |                       +--rw label?
      |     |                               rt-types:mpls-label
      |     +--rw outgoing-type
      |        +--rw (outgoing-type)
      |           +--:(forwarding-sub-layer)
      |           |  +--rw forwarding-sub-layer
      |           |     +--rw service-outgoing-list*
      |           |             [service-outgoing-index]
      |           |        +--rw service-outgoing-index    uint8
      |           |        +--rw (header-type)?
      |           |        |  +--:(detnet-mpls-header)
      |           |        |  |  +--rw mpls-label-stack
      |           |        |  |     +--rw entry* [id]
      |           |        |  |        +--rw id               uint8
      |           |        |  |        +--rw label?
      |           |        |  |        |       rt-types:mpls-label
      |           |        |  |        +--rw ttl?             uint8
      |           |        |  |        +--rw traffic-class?   uint8
      |           |        |  +--:(detnet-ip-header)
      |           |        |     +--rw src-ip-address?
      |           |        |     |       inet:ip-address
      |           |        |     +--rw dest-ip-address?
      |           |        |     |       inet:ip-address
      |           |        |     +--rw next-header?        uint8
      |           |        |     +--rw traffic-class?      uint8
      |           |        |     +--rw flow-label?
      |           |        |     |       inet:ipv6-flow-label
      |           |        |     +--rw source-port?
      |           |        |     |       inet:port-number
      |           |        |     +--rw destination-port?
      |           |        |             inet:port-number
      |           |        +--rw next-layer* [index]
      |           |           +--rw index                   uint8
      |           |           +--rw forwarding-sub-layer?
      |           |                   forwarding-sub-layer-ref
      |           +--:(service-sub-layer)
      |           |  +--rw service-sub-layer
      |           |     +--rw aggregation-service-sub-layer?
      |           |     |       service-sub-layer-ref
      |           |     +--rw service-label
      |           |        +--rw mpls-label-stack
      |           |           +--rw entry* [id]
      |           |              +--rw id               uint8
      |           |              +--rw label?
      |           |              |       rt-types:mpls-label
      |           |              +--rw ttl?             uint8



Geng, et al.              Expires May 20, 2021                 [Page 10]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


      |           |              +--rw traffic-class?   uint8
      |           +--:(upper-app-flow)
      |           |  +--rw upper-app-flow
      |           |     +--rw flow-list*   app-flow-ref
      |           +--:(upper-service-sub-layer)
      |           |  +--rw upper-service-sub-layer
      |           |     +--rw service-sub-layer*
      |           |             service-sub-layer-ref
      |           +--:(upper-forwarding-sub-layer)
      |              +--rw upper-forwarding-sub-layer
      |                 +--rw forwarding-sub-layer*
      |                         forwarding-sub-layer-ref
      +--rw forwarding-sub-layer
         +--rw forwarding-sub-layer-list* [name]
            +--rw name                         string
            +--rw traffic-profile?             traffic-profile-ref
            +--rw forwarding-operation-type?
            |       forwarding-operations-type
            +--rw incoming-type
            |  +--rw (incoming-type)
            |     +--:(service-sub-layer)
            |     |  +--rw service-sub-layer
            |     |     +--ro sub-layer-list*   service-sub-layer-ref
            |     +--:(upper-forwarding-sub-layer)
            |     |  +--rw forwarding-sub-layer*
            |     |          forwarding-sub-layer-ref
            |     +--:(lower-forwarding-sub-layer)
            |        +--rw interface?
            |        |       if:interface-ref
            |        +--rw (detnet-flow-type)?
            |           +--:(ip-detnet-flow)
            |           |  +--rw src-ip-prefix?
            |           |  |       inet:ip-prefix
            |           |  +--rw dest-ip-prefix?
            |           |  |       inet:ip-prefix
            |           |  +--rw next-header?              uint8
            |           |  +--rw traffic-class?            uint8
            |           |  +--rw flow-label?
            |           |  |       inet:ipv6-flow-label
            |           |  +--rw source-port
            |           |  |  +--rw (port-range-or-operator)?
            |           |  |     +--:(range)
            |           |  |     |  +--rw lower-port
            |           |  |     |  |       inet:port-number
            |           |  |     |  +--rw upper-port
            |           |  |     |          inet:port-number
            |           |  |     +--:(operator)
            |           |  |        +--rw operator?     operator



Geng, et al.              Expires May 20, 2021                 [Page 11]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


            |           |  |        +--rw port
            |           |  |                inet:port-number
            |           |  +--rw destination-port
            |           |  |  +--rw (port-range-or-operator)?
            |           |  |     +--:(range)
            |           |  |     |  +--rw lower-port
            |           |  |     |  |       inet:port-number
            |           |  |     |  +--rw upper-port
            |           |  |     |          inet:port-number
            |           |  |     +--:(operator)
            |           |  |        +--rw operator?     operator
            |           |  |        +--rw port
            |           |  |                inet:port-number
            |           |  +--rw ipsec-spi?                ipsec-spi
            |           +--:(mpls-detnet-flow)
            |              +--rw (label-space)?
            |                 +--:(context-label-space)
            |                 |  +--rw mpls-label-stack
            |                 |     +--rw entry* [id]
            |                 |        +--rw id               uint8
            |                 |        +--rw label?
            |                 |        |       rt-types:mpls-label
            |                 |        +--rw ttl?             uint8
            |                 |        +--rw traffic-class?   uint8
            |                 +--:(platform-label-space)
            |                    +--rw label?
            |                            rt-types:mpls-label
            +--rw outgoing-type
               +--rw (outgoing-type)
                  +--:(interface)
                  |  +--rw interface
                  |     +--rw (next-hop-options)
                  |        +--:(simple-next-hop)
                  |        |  +--rw outgoing-interface?
                  |        |  |       if:interface-ref
                  |        |  +--rw (flow-type)?
                  |        |     +--:(ip)
                  |        |     |  +--rw (operation-type)?
                  |        |     |     +--:(ip-forwarding)
                  |        |     |     |  +--rw next-hop-address?
                  |        |     |     |          inet:ip-address
                  |        |     |     +--:(mpls-over-ip-encapsulation)
                  |        |     |        +--rw src-ip-address?
                  |        |     |        |       inet:ip-address
                  |        |     |        +--rw dest-ip-address?
                  |        |     |        |       inet:ip-address
                  |        |     |        +--rw next-header?
                  |        |     |        |       uint8



Geng, et al.              Expires May 20, 2021                 [Page 12]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


                  |        |     |        +--rw traffic-class?
                  |        |     |        |       uint8
                  |        |     |        +--rw flow-label?
                  |        |     |        |       inet:ipv6-flow-label
                  |        |     |        +--rw source-port?
                  |        |     |        |       inet:port-number
                  |        |     |        +--rw destination-port?
                  |        |     |                inet:port-number
                  |        |     +--:(mpls)
                  |        |        +--rw mpls-label-stack
                  |        |           +--rw entry* [id]
                  |        |              +--rw id               uint8
                  |        |              +--rw label?
                  |        |              |       rt-types:mpls-label
                  |        |              +--rw ttl?             uint8
                  |        |              +--rw traffic-class?   uint8
                  |        +--:(next-hop-list)
                  |           +--rw next-hop-list
                  |              +--rw next-hop* [hop-index]
                  |                 +--rw hop-index
                  |                 |       uint8
                  |                 +--rw outgoing-interface?
                  |                 |       if:interface-ref
                  |                 +--rw (flow-type)?
                  |                    +--:(ip)
                  |                    |  +--rw (operation-type)?
                  |                    |     +--:(ip-forwarding)
                  |                    |     |  +--rw next-hop-address?
                  |                    |     |          inet:ip-address
                  |                    |     +--:(mpls-over-ip-
                  |                    |        | encapsulation)
                  |                    |        +--rw src-ip-address?
                  |                    |        |       inet:ip-address
                  |                    |        +--rw dest-ip-address?
                  |                    |        |       inet:ip-address
                  |                    |        +--rw next-header?
                  |                    |        |       uint8
                  |                    |        +--rw traffic-class?
                  |                    |        |       uint8
                  |                    |        +--rw flow-label?
                  |                    |        |       inet:
                  |                    |        |       ipv6-flow-label
                  |                    |        +--rw source-port?
                  |                    |        |       inet:port-number
                  |                    |        +--rw destination-port?
                  |                    |                inet:port-number
                  |                    +--:(mpls)
                  |                       +--rw mpls-label-stack



Geng, et al.              Expires May 20, 2021                 [Page 13]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


                  |                          +--rw entry* [id]
                  |                             +--rw id
                  |                             |       uint8
                  |                             +--rw label?
                  |                             |       rt-types:
                  |                             |       mpls-label
                  |                             +--rw ttl?
                  |                             |       uint8
                  |                             +--rw traffic-class?
                  |                                     uint8
                  +--:(service)
                  |  +--rw aggregation-service-sub-layer?
                  |  |       service-sub-layer-ref
                  |  +--rw optional-forwarding-label
                  |     +--rw mpls-label-stack
                  |        +--rw entry* [id]
                  |           +--rw id               uint8
                  |           +--rw label?
                  |           |       rt-types:mpls-label
                  |           +--rw ttl?             uint8
                  |           +--rw traffic-class?   uint8
                  +--:(forwarding)
                  |  +--rw aggregation-forwarding-sub-layer?
                  |  |       forwarding-sub-layer-ref
                  |  +--rw forwarding-label
                  |     +--rw mpls-label-stack
                  |        +--rw entry* [id]
                  |           +--rw id               uint8
                  |           +--rw label?
                  |           |       rt-types:mpls-label
                  |           +--rw ttl?             uint8
                  |           +--rw traffic-class?   uint8
                  +--:(upper-service)
                  |  +--rw service-sub-layer*
                  |          service-sub-layer-ref
                  +--:(upper-forwarding)
                     +--rw forwarding-sub-layer*
                             forwarding-sub-layer-ref

7.  DetNet Configuration YANG Model

<CODE BEGINS>
module ietf-detnet{
  namespace "urn:ietf:params:xml:ns:yang:ietf-detnet";
  prefix ietf-detnet;

  import ietf-yang-types {
    prefix yang;



Geng, et al.              Expires May 20, 2021                 [Page 14]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


  }
  import ietf-inet-types {
    prefix inet;
  }
  import ietf-ethertypes {
    prefix ethertypes;
  }
  import ietf-routing-types {
    prefix rt-types;
  }
  import ietf-packet-fields {
    prefix packet-fields;
  }
  import ietf-interfaces {
    prefix if;
  }
  import ieee802-dot1q-types{
    prefix dot1q-types;
  }

  organization
    "IETF DetNet Working Group";
  contact
    "WG Web:   <http://tools.ietf.org/wg/detnet/>
     WG List:  <mailto: detnet@ietf.org>
     WG Chair: Lou Berger
                 <mailto:lberger@labn.net>

                 Janos Farkas
                 <mailto:janos.farkas@ericsson.com>

     Editor:   Xuesong Geng
                <mailto:gengxuesong@huawei.com>

     Editor:   Mach Chen
                <mailto:mach.chen@huawei.com>

     Editor:   Yeoncheol Ryoo
                <mailto:dbduscjf@etri.re.kr>

     Editor:   Don Fedyk
                <mailto:dfedyk@labn.net>;

     Editor:   Reshad Rahman
                <mailto:rrahman@cisco.com>

     Editor:   Zhenqiang Li
                <mailto:lizhenqiang@chinamobile.com>";



Geng, et al.              Expires May 20, 2021                 [Page 15]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


  description
    "This YANG module describes the parameters needed
     for DetNet flow configuration and flow status
     reporting";

  revision 2020-11-12 {
    description
      "initial revision";
    reference
      "RFC XXXX: draft-ietf-detnet-yang-09";
  }

  identity app-status {
    description
      "Base identity from which all application-status
       actions are derived";
  }

  identity none {
    base app-status;
    description
      "Application no ingress/egress";
    reference
      "draft-ietf-detnet-flow-information-model Section 5.8";
  }

  identity ready {
    base app-status;
    description
      "Application ingress/egress ready";
    reference
      "draft-ietf-detnet-flow-information-model Section 5.8";
  }

  identity failed {
    base app-status;
    description
      "Application ingres/egresss failed";
    reference
      "draft-ietf-detnet-flow-information-model Section 5.8";
  }

  identity out-of-service {
    base app-status;
    description
      "Application Administratively blocked";
    reference
      "draft-ietf-detnet-flow-information-model Section 5.8";



Geng, et al.              Expires May 20, 2021                 [Page 16]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


  }

  identity partial-failed {
    base app-status;
    description
      "Application One or more Egress ready, and one or more Egress
       failed.  The DetNet flow can be used if the Ingress is
       Ready.";
    reference
      "draft-ietf-detnet-flow-information-model Section 5.8";
  }

  typedef app-flow-ref {
    type leafref {
      path "/ietf-detnet:detnet"
         + "/ietf-detnet:app-flows"
         + "/ietf-detnet:app-flow"
         + "/ietf-detnet:name";
    }
  }

  typedef service-sub-layer-ref {
    type leafref {
      path "/ietf-detnet:detnet"
         + "/ietf-detnet:service-sub-layer"
         + "/ietf-detnet:service-sub-layer-list"
         + "/ietf-detnet:name";
    }
  }

  typedef forwarding-sub-layer-ref {
    type leafref {
      path "/ietf-detnet:detnet"
         + "/ietf-detnet:forwarding-sub-layer"
         + "/ietf-detnet:forwarding-sub-layer-list"
         + "/ietf-detnet:name";
    }
  }

  typedef traffic-profile-ref {
    type leafref {
      path "/ietf-detnet:detnet"
         + "/ietf-detnet:traffic-profile"
         + "/ietf-detnet:profile-name";
    }
  }

  typedef ipsec-spi {



Geng, et al.              Expires May 20, 2021                 [Page 17]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


    type uint32 {
      range "1..max";
    }
    description
      "IPsec Security Parameters Index";
    reference
      "IETF RFC 6071";
  }

  typedef service-operation-type {
    type enumeration {
      enum service-initiation {
        description
          "Operation for DetNet service sub-layer encapsulation";
      }
      enum service-termination {
        description
          "Operation for DetNet service sub-layer decapsulation";
      }
      enum service-relay {
        description
          "Operation for DetNet service sub-layer swap";
      }
      enum non-detnet {
        description
          "No operation for DetNet service sub-layer";
      }
    }
  }

  typedef forwarding-operations-type {
    type enumeration {
      enum forward {
        description
          "Operation forward to next-hop";
      }
      enum impose-and-forward {
        description
          "Operation impose outgoing label(s) and forward to
           next-hop";
      }
      enum pop-and-forward {
        description
          "Operation pop incoming label and forward to next-hop";
      }
      enum pop-impose-and-forward {
        description
          "Operation pop incoming label, impose one or more



Geng, et al.              Expires May 20, 2021                 [Page 18]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


           outgoing label(s) and forward to next-hop";
      }
      enum swap-and-forward {
        description
          "Operation swap incoming label, with outgoing label and
           forward to next-hop";
      }
      enum pop-and-lookup {
        description
          "Operation pop incoming label and perform a lookup";
      }
    }
    description
      "MPLS operations types";
  }

  typedef service-protection-type {
    type enumeration {
      enum none {
        description
          "no service protection provide";
      }
      enum replication {
        description
          "A Packet Replication Function (PRF) replicates
           DetNet flow packets and forwards them to one or
           more next hops in the DetNet domain.  The number
           of packet copies sent to each next hop is a
           DetNet flow specific parameter at the node doing
           the replication.  PRF can be implemented by an
           edge node, a relay node, or an end system";
      }
      enum elimination {
        description
          "A Packet Elimination Function (PEF) eliminates
           duplicate copies of packets to prevent excess
           packets flooding the network or duplicate
           packets being sent out of the DetNet domain.
           PEF can be implemented by an edge node, a relay
           node, or an end system.";
      }
      enum ordering {
        description
          "A Packet Ordering Function (POF) re-orders
           packets within a DetNet flow that are received
           out of order.  This function can be implemented
           by an edge node, a relay node, or an end system.";
      }



Geng, et al.              Expires May 20, 2021                 [Page 19]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


      enum elimination-ordering {
        description
          "A combination of PEF and POF that can be
           implemented by an edge node, a relay node, or
           an end system.";
      }
      enum elimination-replication {
        description
          "A combination of PEF and PRF that can be
           implemented by an edge node, a relay node, or
           an end system";
      }
      enum elimination-ordering-replicaiton {
        description
          "A combination of PEF, POF and PRF that can be
           implemented by an edge node, a relay node, or
           an end system";
      }
    }
  }

  typedef sequence-number-generation-type {
    type enumeration {
      enum copy-from-app-flow {
        description
          "Copy the app-flow sequence number to the DetNet-flow";
      }
      enum generate-by-detnet-flow {
        description
          "Generate the sequence number by DetNet flow";
      }
    }
  }

  typedef sequence-number-field {
    type enumeration {
      enum zero-sn {
        description
          "There is no DetNet sequence number field.";
      }
      enum short-sn {
        value 16;
        description
          "There is 16bit DetNet sequence number field";
      }
      enum long-sn {
        value 28;
        description



Geng, et al.              Expires May 20, 2021                 [Page 20]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


          "There is 28bit DetNet sequence number field";
      }
    }
  }

  grouping ip-header {
    description
      "The IPv4/IPv6 packet header information";
    leaf src-ip-address {
      type inet:ip-address;
      description
        "The source IP address in the header";
    }
    leaf dest-ip-address {
      type inet:ip-address;
      description
        "The destination IP address in the header";
    }
    leaf next-header {
      type uint8;
      description
        "The next header of the IPv6 header";
    }
    leaf traffic-class {
      type uint8;
      description
        "The traffic class value of the header";
    }
    leaf flow-label {
      type inet:ipv6-flow-label;
      description
        "The flow label value of the header";
    }
    leaf source-port {
      type inet:port-number;
      description
        "The source port number";
    }
    leaf destination-port {
      type inet:port-number;
      description
        "The destination port number";
    }
  }

  grouping l2-header {
    description
      "The Ethernet or TSN packet header information";



Geng, et al.              Expires May 20, 2021                 [Page 21]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


    leaf source-mac-address {
      type yang:mac-address;
      description
        "The source MAC address value of the Ethernet header";
    }
    leaf destination-mac-address {
      type yang:mac-address;
      description
        "The destination MAC address value of the Ethernet header";
    }
    leaf ethertype {
      type ethertypes:ethertype;
      description
        "The Ethernet packet type value of the Ethernet header";
    }
    leaf vlan-id {
      type dot1q-types:vlanid;
      description
        "The VLAN value of the Ethernet header";
    }
    leaf pcp {
      type uint8;
      description
        "The priority value of the Ethernet header";
    }
  }

  grouping destination-ip-port-identification {
    description
      "The TCP/UDP port(source/destination) identification information";
    container destination-port {
      uses packet-fields:port-range-or-operator;
    }
  }

  grouping source-ip-port-identification {
    description
      "The TCP/UDP port(source/destination) identification information";
    container source-port {
      uses packet-fields:port-range-or-operator;
    }
  }

  grouping ip-flow-identification {
    description
      "The IPv4/IPv6 packet header identification information";
    leaf src-ip-prefix {
      type inet:ip-prefix;



Geng, et al.              Expires May 20, 2021                 [Page 22]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


      description
        "The source IP address of the header";
    }
    leaf dest-ip-prefix {
      type inet:ip-prefix;
      description
        "The destination IP address of the header";
    }
    leaf next-header {
      type uint8;
      description
        "The next header of the IPv6 header";
    }
    leaf traffic-class {
      type uint8;
      description
        "The traffic class value of the header";
    }
    leaf flow-label {
      type inet:ipv6-flow-label;
      description
        "The flow label value of the header";
    }
    uses source-ip-port-identification;
    uses destination-ip-port-identification;
    leaf ipsec-spi {
      type ipsec-spi;
      description
        "IPsec Security Parameters Index of the Security Association";
      reference
        "IETF RFC 6071";
    }
  }

  grouping mpls-flow-identification {
    description
      "The MPLS packet header identification information";
    choice label-space {
      description
        "Designates the label space being used.";
      case context-label-space {
        uses rt-types:mpls-label-stack;
      }
      case platform-label-space {
        leaf label {
          type rt-types:mpls-label;
        }
      }



Geng, et al.              Expires May 20, 2021                 [Page 23]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


    }
  }

  grouping traffic-specification {
    container traffic-specification {
      description
        "traffic-specification specifies how the Source
         transmits packets for the flow.  This is the
         promise/request of the Source to the network.
         The network uses this traffic specification
         to allocate resources and adjust queue
         parameters in network nodes.";
      reference
        "draft-ietf-detnet-flow-information-model Section 4.1";
      leaf interval {
        type uint32;
        units microseconds;
        description
          "The period of time in which the traffic
           specification cannot be exceeded.";

      }
      leaf max-packets-per-interval {
        type uint32;
        description
          "The maximum number of packets that the
           source will transmit in one Interval.";
      }
      leaf max-payload-size {
        type uint32;
        description
          "The maximum payload size that the source
           will transmit.";
      }
      leaf average-packets-per-interval {
        type uint32;
        description
          "The average number of packets that the
           source will transmit in one interval";
      }
      leaf average-payload-size {
        type uint32;
        description
          "The average payload size that the
           source will transmit.";
      }
    }
  }



Geng, et al.              Expires May 20, 2021                 [Page 24]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


  grouping traffic-requirements {
    container traffic-requirements {
      description
        "FlowRequirements: defines the attributes of the App-flow
         regarding bandwidth, latency, latency variation, loss, and
         misordering tolerance.";
      reference
        "draft-ietf-detnet-flow-information-model Section 4.2";
      leaf min-bandwidth {
        type uint64;
        units bytes-per-second;
        description
          "MinBandwidth is the minimum bandwidth that has to be
           guaranteed for the DetNet service.  MinBandwidth is
           specified in octets per second.";
      }
      leaf max-latency {
        type uint32;
        units microseconds;
        description
          "MaxLatency is the maximum latency from Ingress to Egress(es)
           for a single packet of the DetNet flow.  MaxLatency is
           specified as an integer number of nanoseconds";
      }
      leaf max-latency-variation {
        type uint32;
        description
          "MaxLatencyVariation is the difference between the minimum and
           the maximum end-to-end one-way latency.  MaxLatencyVariation
           is specified as an integer number of nanoseconds.";
      }
      leaf max-loss {
        type uint32;
        description
          "MaxLoss defines the maximum Packet Loss Ratio (PLR) parameter
           for the DetNet service between the Ingress and Egress(es) of
           the DetNet domain.";
      }
      leaf max-consecutive-loss-tolerance {
        type uint32;
        units packets;
        description
          "Some applications have special loss requirement, such as
           MaxConsecutiveLossTolerance.  The maximum consecutive loss
           tolerance parameter describes the maximum number of
           consecutive packets whose loss can be tolerated.  The maximum
           consecutive loss tolerance can be measured for example based
           on sequence number";



Geng, et al.              Expires May 20, 2021                 [Page 25]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


      }
      leaf max-misordering {
        type uint32;
        units packets;
        description
          "MaxMisordering describes the tolerable maximum number of
           packets that can be received out of order.  The maximum
           allowed misordering can be measured for example based on
           sequence number.  The value zero for the maximum allowed
           misordering indicates that in order delivery is required,
           misordering cannot be tolerated.";
      }
    }
  }

  grouping data-flow-spec {
    description
      "app-flow identification";
    choice data-flow-type {
      case tsn-app-flow {
        uses l2-header;
      }
      case ip-app-flow {
        uses ip-flow-identification;
      }
      case mpls-app-flow {
        uses mpls-flow-identification;
      }
    }
  }

  grouping detnet-flow-spec {
    description
      "detnet-flow identification";
    choice detnet-flow-type {
      case ip-detnet-flow {
        uses ip-flow-identification;
      }
      case mpls-detnet-flow {
        uses mpls-flow-identification;
      }
    }
  }

  grouping app-flows-ref {
    description
      "incoming or outgoing app-flow reference group";
    leaf-list flow-list{



Geng, et al.              Expires May 20, 2021                 [Page 26]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


      type app-flow-ref;
      description
        "List of ingress or egress app-flows";
    }
  }

  grouping service-sub-layer-ref {
    description
      "incoming or outgoing service sub-layer reference group";
    leaf-list service-sub-layer {
      type service-sub-layer-ref;
      description
        "List of incoming or outgoing service sub-layers
         that have to aggregate or disaggregate";
    }
  }

  grouping forwarding-sub-layer-ref {
    description
      "incoming or outgoing forwarding sub-layer reference group";
    leaf-list forwarding-sub-layer {
      type forwarding-sub-layer-ref;
      description
        "List of incoming or outgoing forwarding sub-layers
         that have to aggregate or disaggregate";
    }
  }

  grouping detnet-header {
    description
      "DetNet header info for DetNet encapsulation or swap";
    choice header-type {
      case detnet-mpls-header {
        description
        "MPLS label stack for DetNet MPLS encapsulation or
         forwarding";
        uses rt-types:mpls-label-stack;
      }
      case detnet-ip-header {
        description
          "IPv4/IPv6 packet header for DetNet IP encapsulation";
        uses ip-header;
      }
    }
  }

  grouping detnet-app-next-hop-content {
    description



Geng, et al.              Expires May 20, 2021                 [Page 27]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


      "Generic parameters of DetNet next hops.";
    choice next-hop-options {
      mandatory true;
      description
        "Options for next hops.
         It is expected that further cases will be added through
         augments from other modules, e.g., for recursive
         next hops.";
      case simple-next-hop {
        description
          "This case represents a simple next hop consisting of the
           next-hop address and/or outgoing interface.
           Modules for address families MUST augment this case with a
           leaf containing a next-hop address of that address
           family.";
        leaf outgoing-interface {
          type if:interface-ref;
        }
        choice flow-type {
          case ip {
            leaf next-hop-address {
              type inet:ip-address;
            }
          }
          case mpls {
            uses rt-types:mpls-label-stack;
          }
        }
      }
      case next-hop-list {
        container next-hop-list {
          description
            "Container for multiple next hops.";
          list next-hop {
            key "hop-index";
            description
              "An entry in a next-hop list.
               Modules for address families MUST augment this list
               with a leaf containing a next-hop address of that
               address family.";
            leaf hop-index {
              type uint8;
              description
                "The value if the index of for a hop.";
            }
            leaf outgoing-interface {
              type if:interface-ref;
            }



Geng, et al.              Expires May 20, 2021                 [Page 28]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


            choice flow-type {
              case ip {
                leaf next-hop-address {
                  type inet:ip-address;
                }
              }
              case mpls {
                uses rt-types:mpls-label-stack;
              }
            }
          }
        }
      }
    }
  }

  grouping detnet-forwarding-next-hop-content {
    description
      "Generic parameters of DetNet next hops.";
    choice next-hop-options {
      mandatory true;
      description
        "Options for next hops.
         It is expected that further cases will be added through
         augments from other modules, e.g., for recursive
         next hops.";
      case simple-next-hop {
        description
          "This case represents a simple next hop consisting of the
           next-hop address and/or outgoing interface.
           Modules for address families MUST augment this case with a
           leaf containing a next-hop address of that address
           family.";
        leaf outgoing-interface {
          type if:interface-ref;
        }
        choice flow-type {
          case ip {
            choice operation-type {
              case ip-forwarding {
                leaf next-hop-address {
                  type inet:ip-address;
                }
              }
              case mpls-over-ip-encapsulation {
                uses ip-header;
              }
            }



Geng, et al.              Expires May 20, 2021                 [Page 29]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


          }
          case mpls {
            uses rt-types:mpls-label-stack;
          }
        }
      }
      case next-hop-list {
        container next-hop-list {
          description
            "Container for multiple next hops.";
          list next-hop {
            key "hop-index";
            description
              "An entry in a next-hop list.

               Modules for address families MUST augment this list
               with a leaf containing a next-hop address of that
               address family.";
            leaf hop-index {
              type uint8;
              description
                "The value if the index of for a hop.";
            }
            leaf outgoing-interface {
              type if:interface-ref;
            }
            choice flow-type {
              case ip {
                choice operation-type {
                  case ip-forwarding {
                    leaf next-hop-address {
                      type inet:ip-address;
                    }
                  }
                  case mpls-over-ip-encapsulation {
                    uses ip-header;
                  }
                }
              }
              case mpls {
                uses rt-types:mpls-label-stack;
              }
            }
          }
        }
      }
    }
  }



Geng, et al.              Expires May 20, 2021                 [Page 30]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


  container detnet {
    list traffic-profile {
      key "profile-name";
      description
        "A traffic profile";
      leaf profile-name {
        type string;
        description
          "An Aggregation group ID. Zero means the service is not
           part of a group";
      }
      uses traffic-requirements;
      uses traffic-specification;
      leaf-list member-applications {
        type app-flow-ref;
        config false;
        description
          "Applications attached to this profile";
      }
      leaf-list member-services {
        type service-sub-layer-ref;
        config false;
        description
          "Services attached to this profile";
      }
      leaf-list member-forwarding-sublayers {
        type forwarding-sub-layer-ref;
        config false;
        description
          "Forwarding sub-layer attached to this profile";
      }
    }
    container app-flows {
      description
        "The DetNet app-flow configuration";
      reference
        "draft-ietf-detnet-flow-information-model Section Section 4.1";
      list app-flow {
        key "name";
        description
          "A unique (management) identifier of the App-flow.";
        leaf name {
          type string;
          description
            "A unique (management) identifier of the App-flow.";
          reference
            "draft-ietf-detnet-flow-information-model
             Sections 4.1, 5.1";



Geng, et al.              Expires May 20, 2021                 [Page 31]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


        }
        leaf app-flow-bidir-congruent {
          type boolean;
          description
            "Defines the data path requirement of the App-flow whether
             it must share the same data path and physical path
             for both directions through the network,
             e.g., to provide congruent paths in the two directions.";
          reference
            "draft-ietf-detnet-flow-information-model Section 4.2";
        }
        leaf outgoing-service {
          type service-sub-layer-ref;
          config false;
          description
            "Binding to this applications outgoing
             service";
        }
        leaf incoming-service {
          type service-sub-layer-ref;
          config false;
          description
            "Binding to this applications incoming
             service";
        }
        leaf traffic-profile {
          type traffic-profile-ref;
          description
            "The Traffic Profile for this group";
        }
        container ingress {
          // key "name";  This should be a list for aggregation
          description
            "Ingress DetNet application flows or a compound flow";
          leaf name {
            type string;
            description
              "Ingress DetNet application";
          }
          leaf app-flow-status {
            type identityref {
              base app-status;
            }
            config false;
            description
              "Status of ingress application flow";
            reference
              "draft-ietf-detnet-flow-information-model



Geng, et al.              Expires May 20, 2021                 [Page 32]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


               Sections 4.1, 5.8";
          }
          leaf interface {
            type if:interface-ref;
          }
          uses data-flow-spec;
        } //End of app-ingress
        container egress {
          description
            "Route's next-hop attribute.";
          // key "name";  This should be a list for aggregation
          leaf name {
            type string;
            description
              "Egress DetNet application";
          }
          choice application-type {
            container Ethernet {
              leaf Ethernet-place-holder {
                type string;
                description
                  "Place holder for matching Ethernet";
              }
            }
            container ip-mpls {
              uses detnet-app-next-hop-content;
            }
          }
        }
      }
    }
    container service-sub-layer {
      description
        "The DetNet service sub-layer configuration";
      list service-sub-layer-list {
        key "name";
        description
          "Services are indexed by name";
        leaf name {
          type string;
          description
            "The name of the DetNet service sub-layer";
        }
        leaf service-rank {
          type uint8;
          description
            "The DetNet rank for this service";
          reference



Geng, et al.              Expires May 20, 2021                 [Page 33]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


            "draft-ietf-detnet-flow-information-model Section 5.7";
        }
        leaf traffic-profile {
          type traffic-profile-ref;
          description
            "The Traffic Profile for this service";
        }
        container service-protection {
          leaf service-protection-type {
            type service-protection-type;
            description
              "The DetNet service protection type such as PRF, PEF,
               PEOF,PERF, and PEORF";
            reference
              "draft-ietf-detnet-data-plane-framework Section 4.3";
          }
          leaf sequence-number-length {
            type sequence-number-field;
            description
              "Sequence number field length can be one of 0 (none),
               16 bits or 28 bits.";
          }
        }
        leaf service-operation-type {
          type service-operation-type;
        }
        container incoming-type {
          description
            "The DetNet service sub-layer incoming configuration.";
          choice incoming-type {
            mandatory true;
            description
              "";
            container app-flow {
              description
                "This service sub-layer is related to
                 the app-flows of the upper layer
                 and provide ingress proxy or ingress aggregation
                 at the ingress node.";
              uses app-flows-ref;
            }
            container service {
              description
                "This service sub-layer is related to
                 the service sub-layer of the upper layer
                 and provide service-to-service aggregation
                 at the ingress node or relay node.";
              uses service-sub-layer-ref;



Geng, et al.              Expires May 20, 2021                 [Page 34]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


            }
            container forwarding {
              description
                "This service sub-layer is related to
                 the forwarding sub-layer of the upper layer
                 and provide forwarding-to-service aggregation
                 at the ingress node or relay node.";
              uses forwarding-sub-layer-ref;
            }
            container service-identification {
              description
                "This service sub-layer is related to
                 the service or forwarding sub-layer of the lower layer
                 and provide DetNet service relay or termination
                 at the relay node or egress node.";
              uses detnet-flow-spec;
            }
          }
        }
        container outgoing-type {
          description
            "The DetNet service sub-layer outgoing configuration.";
          choice outgoing-type {
            mandatory true;
            description
              "";
            container forwarding-sub-layer {
              description
                "This service sub-layer is sent to the forwarding
                 sub-layers of the lower layer for DetNet service
                 forwarding or service-to-forwarding aggregation at
                 the ingress node or relay node.  When the operation
                 type is service-initiation, The service sub-layer
                 encapsulates the DetNet Control-Word and services
                 label, which are for individual DetNet flow when the
                 incoming type is app-flow and for aggregated DetNet
                 flow when the incoming type is service or
                 forwarding.  The service sub-layer swaps the service
                 label when the operation type is service-relay.";
              list service-outgoing-list {
                key "service-outgoing-index";
                description
                  "list of the outgoing service
                   that separately for each node
                   where services will be eliminated";
                leaf service-outgoing-index {
                  type uint8;
                }



Geng, et al.              Expires May 20, 2021                 [Page 35]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


                uses detnet-header;
                list next-layer {
                  key "index";
                  description
                    "list of the forwarding-sub-layer
                     for replicate to multiple paths";
                  leaf index {
                    type uint8;
                  }
                  leaf forwarding-sub-layer {
                    type forwarding-sub-layer-ref;
                    description
                      "forwarding-sub-layer reference point";
                  }
                }
              }
            }
            container service-sub-layer {
              description
                "This service sub-layer is sent to the service
                 sub-layers of the lower layer for service-to-service
                 aggregation at the ingress node or relay node.  The
                 service sub-layer encapsulates the DetNet
                 Control-Word and S-label when the operation type is
                 service-initiation, and swaps the S-label when the
                 operation type is service-relay.";
              leaf aggregation-service-sub-layer {
                type service-sub-layer-ref;
                description
                  "reference point of the service-sub-layer
                   at which this service will be aggregated";
              }
              container service-label {
                uses rt-types:mpls-label-stack;
              }
            }
            container upper-app-flow {
              description
                "This service sub-layer is sent to the app-flow of
                 the upper layer for egress proxy at the egress node,
                 and decapsulates the DetNet Control-Word and S-label
                 for individual DetNet service.  This outgoing type
                 only can be chosen when the operation type is
                 service-termination.";
              uses app-flows-ref;
            }
            container upper-service-sub-layer {
              description



Geng, et al.              Expires May 20, 2021                 [Page 36]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


                "This service sub-layer is sent to the service
                 sub-layer of the upper layer for service-to-service
                 disaggregation at the relay node or egress node, and
                 decapsulates the DetNet Control-Word and A-label for
                 aggregated DetNet service.  This outgoing type only
                 can be chosen when the operation type is
                 service-termination.";
              uses service-sub-layer-ref;
            }
            container upper-forwarding-sub-layer {
              description
                "This service sub-layer is sent to the forwarding
                 sub-layer of the upper layer for
                 forwarding-to-service disaggregation at the relay
                 node or egress node, and decapsulates the DetNet
                 Control-Word and A-label for aggregated DetNet
                 service.  This outgoing type only can be chosen when
                 the operation type is service-termination";
              uses forwarding-sub-layer-ref;
            }
          }
        }
      }
    }
    container forwarding-sub-layer {
      description
        "The DetNet forwarding sub-layer configuration";
      list forwarding-sub-layer-list {
        key "name";
        description
          "";
        leaf name {
          type string;
          description
            "The name of the DetNet forwarding sub-layer";
        }
        leaf traffic-profile {
          type traffic-profile-ref;
          description
            "The Traffic Profile for this group";
        }
        leaf forwarding-operation-type {
          type forwarding-operations-type;
        }
        container incoming-type {
          description
            "The DetNet forwarding sub-layer incoming configuration.";
          choice incoming-type {



Geng, et al.              Expires May 20, 2021                 [Page 37]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


            mandatory true;
            description
              "Cases of incoming types";
            container service-sub-layer {
              description
                "This forwarding sub-layer is related to the service
                 sub-layers of the upper layer and provide DetNet
                 forwarding or service-to-forwarding aggregation at
                 the ingress node or relay node.";
              leaf-list sub-layer-list {
                type service-sub-layer-ref;
                config false;
                description
                  "";
              }
            }
            case upper-forwarding-sub-layer {
              description
                "This forwarding sub-layer is related to the
                 forwarding sub-layer of the upper layer and provide
                 forwarding-to-forwarding aggregation at the ingress
                 node or relay node or transit node.";
              uses forwarding-sub-layer-ref;
            }
            case lower-forwarding-sub-layer {
            //case forwarding-identification {
              description
                "This forwarding sub-layer is related to all of the
                 lower layer and provide DetNet forwarding swap or
                 termination at the transit node or relay node or
                 egress node.";
              leaf interface {
                type if:interface-ref;
                description
                  "This is the interface associated with the forwarding
                   sub-layer";
              }
              uses detnet-flow-spec;
            }
          }
        }
        container outgoing-type {
          description
            "The DetNet forwarding sub-layer outbound configuration.";
          choice outgoing-type {
            mandatory true;
            description
              "";



Geng, et al.              Expires May 20, 2021                 [Page 38]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


            container interface {
              description
                "This forwarding sub-layer is sent to the interface
                 for send to next-hop at the ingress node or relay
                 node or transit node.";
              uses detnet-forwarding-next-hop-content;
            }
            case service {
              description
                "This forwarding sub-layer is sent to the service
                 sub-layers of the lower layer for
                 forwarding-to-service aggregation at the ingress
                 node or relay node.";
              leaf aggregation-service-sub-layer {
                type service-sub-layer-ref;
              }
              container optional-forwarding-label {
                uses rt-types:mpls-label-stack;
              }
            }
            case forwarding {
              description
                "This forwarding sub-layer is sent to the forwarding
                 sub-layers of the lower layer for
                 forwarding-to-forwarding aggregation at the ingress
                 node or relay node or transit node.";
              leaf aggregation-forwarding-sub-layer {
                type forwarding-sub-layer-ref;
              }
              container forwarding-label {
                uses rt-types:mpls-label-stack;
              }
            }
            case upper-service {
              description
                "This forwarding sub-layer is sent to the service
                 sub-layer of the upper layer and decapsulate the
                 F-label for DetNet service or service-to-forwarding
                 disaggregation at the relay node or egress node.
                 This outgoing type only can be chosen when the
                 operation type is pop-and-lookup";
              uses service-sub-layer-ref;
            }
            case upper-forwarding {
              description
                "This forwarding sub-layer is sent to the forwarding
                 sub-layer of the upper layer and decapsulate the
                 F-label for forwarding-to-forwarding disaggregation



Geng, et al.              Expires May 20, 2021                 [Page 39]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


                 at the transit node or relay node or egress node.
                 This outgoing type only can be chosen when the
                 operation type is pop-and-lookup";
              uses forwarding-sub-layer-ref;
            }
          }
        }
      }
    }
  }
}
<CODE ENDS>

8.  Open Issues

   There are some open issues that are still under discussion:

   o  Terminology.

   o  Security Considerations.

   These issues will be resolved in the following versions of the draft.

9.  IANA Considerations

   This document makes no request of IANA.

   Note to RFC Editor: this section may be removed on publication as an
   RFC.

10.  Security Considerations

   <TBD>

11.  Acknowledgements

12.  References

12.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC6991]  Schoenwaelder, J., Ed., "Common YANG Data Types",
              RFC 6991, DOI 10.17487/RFC6991, July 2013,
              <https://www.rfc-editor.org/info/rfc6991>.



Geng, et al.              Expires May 20, 2021                 [Page 40]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


   [RFC7950]  Bjorklund, M., Ed., "The YANG 1.1 Data Modeling Language",
              RFC 7950, DOI 10.17487/RFC7950, August 2016,
              <https://www.rfc-editor.org/info/rfc7950>.

   [RFC8655]  Finn, N., Thubert, P., Varga, B., and J. Farkas,
              "Deterministic Networking Architecture", RFC 8655,
              DOI 10.17487/RFC8655, October 2019,
              <https://www.rfc-editor.org/info/rfc8655>.

12.2.  Informative References

   [I-D.ietf-detnet-flow-information-model]
              Varga, B., Farkas, J., Cummings, R., Jiang, Y., and D.
              Fedyk, "DetNet Flow Information Model", draft-ietf-detnet-
              flow-information-model-11 (work in progress), October
              2020.

Appendix A.  Examples

   The following examples are provided.

   o  A simple DetNet application illustrting multiplexing of
      Application Flows.

   o  A case of Forwarding sub-layer aggregation using a single
      forwarding sublayer.

   o  A case of Service sub-layer aggregation with and aggrgation label.

A.1.  Example JSON Configuration

   {
     "ietf-interfaces:interfaces": {
       "interface": [
         {
           "name": "eth0",
           "type": "iana-if-type:ethernetCsmacd",
           "oper-status": "up",
           "statistics": {
             "discontinuity-time": "2020-10-02T23:59:00Z"
           }
         },
         {
           "name": "eth1",
           "type": "iana-if-type:ethernetCsmacd",
           "oper-status": "up",
           "statistics": {
             "discontinuity-time": "2020-10-02T23:59:00Z"



Geng, et al.              Expires May 20, 2021                 [Page 41]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


           }
         },
         {
           "name": "eth2",
           "type": "iana-if-type:ethernetCsmacd",
           "oper-status": "up",
           "statistics": {
             "discontinuity-time": "2020-10-02T23:59:00Z"
           }
         },
         {
           "name": "eth3",
           "type": "iana-if-type:ethernetCsmacd",
           "oper-status": "up",
           "statistics": {
             "discontinuity-time": "2020-10-02T23:59:00Z"
           }
         },
         {
           "name": "eth4",
           "type": "iana-if-type:ethernetCsmacd",
           "oper-status": "up",
           "statistics": {
             "discontinuity-time": "2020-10-02T23:59:00Z"
           }
         }
       ]
     },
     "ietf-detnet:detnet": {
       "app-flows": {
         "app-flow": [
           {
             "name": "app-0",
             "app-flow-bidir-congruent": false,
             "outgoing-service": "ssl-1",
             "traffic-profile": "pf-1",
             "ingress": {
               "app-flow-status": "ready",
               "interface": "eth0",
               "src-ip-prefix": "1.1.1.1/32",
               "dest-ip-prefix": "8.8.8.8/32",
               "traffic-class": 6
             }
           },
           {
             "name": "app-1",
             "app-flow-bidir-congruent": false,
             "outgoing-service": "ssl-1",



Geng, et al.              Expires May 20, 2021                 [Page 42]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


             "traffic-profile": "pf-1",
             "ingress": {
               "app-flow-status": "ready",
               "interface": "eth0",
               "src-ip-prefix": "1.1.1.1/32",
               "dest-ip-prefix": "8.8.8.8/32",
               "traffic-class": 7
             }
           }
         ]
       },
       "traffic-profile": [
         {
           "profile-name": "pf-1",
           "traffic-requirements": {
             "min-bandwidth": "100000000",
             "max-latency": 100000000,
             "max-latency-variation": 200000000,
             "max-loss": 2,
             "max-consecutive-loss-tolerance": 5,
             "max-misordering": 0
           },
           "traffic-specification": {
             "interval": 5,
             "max-packets-per-interval": 10,
             "max-payload-size": 1500,
             "average-packets-per-interval": 5,
             "average-payload-size": 1000
           },
           "member-applications": [
             "app-0",
             "app-1"
           ]
         },
         {
           "profile-name": "pf-2",
           "traffic-requirements": {
             "min-bandwidth": "200000000",
             "max-latency": 100000000,
             "max-latency-variation": 200000000,
             "max-loss": 2,
             "max-consecutive-loss-tolerance": 5,
             "max-misordering": 0
           },
           "traffic-specification": {
             "interval": 5,
             "max-packets-per-interval": 10,
             "max-payload-size": 1500,



Geng, et al.              Expires May 20, 2021                 [Page 43]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


             "average-packets-per-interval": 5,
             "average-payload-size": 1000
           },
           "member-services": [
             "ssl-1"
           ]
         },
         {
           "profile-name": "pf-3",
           "traffic-specification": {
             "interval": 5,
             "max-packets-per-interval": 10,
             "max-payload-size": 1500
           },
           "member-forwarding-sublayers": [
             "fsl-1"
           ]
         }
       ],
       "service-sub-layer": {
         "service-sub-layer-list": [
           {
             "name": "ssl-1",
             "service-rank": 10,
             "traffic-profile": "pf-2",
             "service-operation-type": "service-initiation",
             "service-protection": {
               "service-protection-type": "none",
               "sequence-number-length": "long-sn"
             },
             "incoming-type": {
               "app-flow": {
                 "flow-list": [
                   "app-0",
                   "app-1"
                 ]
               }
             },
             "outgoing-type": {
               "forwarding-sub-layer": {
                 "service-outgoing-list": [
                   {
                     "service-outgoing-index": 0,
                     "mpls-label-stack": {
                       "entry": [
                         {
                           "id": 0,
                           "label": 100



Geng, et al.              Expires May 20, 2021                 [Page 44]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


                         }
                       ]
                     },
                     "next-layer": [
                       {
                         "index": 0,
                         "forwarding-sub-layer": "fsl-1"
                       }
                     ]
                   }
                 ]
               }
             }
           }
         ]
       },
       "forwarding-sub-layer": {
         "forwarding-sub-layer-list": [
           {
             "name": "fsl-1",
             "traffic-profile": "pf-3",
             "forwarding-operation-type": "impose-and-forward",
             "incoming-type": {
               "service-sub-layer": {
                 "sub-layer-list": [
                   "ssl-1"
                 ]
               }
             },
             "outgoing-type": {
               "interface": {
                 "outgoing-interface": "eth2"
               }
             }
           }
         ]
       }
     }
   }

                Figure 1: Example DetNet JSON configuration

A.2.  Example XML Config: Aggregation using a Forwarding Sublayer

<interfaces
  xmlns="urn:ietf:params:xml:ns:yang:ietf-interfaces"
  xmlns:ia="urn:ietf:params:xml:ns:yang:iana-if-type">
    <interface>



Geng, et al.              Expires May 20, 2021                 [Page 45]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


      <name>eth0</name>
      <type>ia:ethernetCsmacd</type>
      <oper-status>up</oper-status>
      <statistics>
         <discontinuity-time>2020-10-02T23:59:00Z</discontinuity-time>
      </statistics>
    </interface>
    <interface>
      <name>eth1</name>
      <type>ia:ethernetCsmacd</type>
      <oper-status>up</oper-status>
      <statistics>
         <discontinuity-time>2020-10-02T23:59:00Z</discontinuity-time>
      </statistics>
    </interface>
    <interface>
      <name>eth2</name>
      <type>ia:ethernetCsmacd</type>
      <oper-status>up</oper-status>
      <statistics>
         <discontinuity-time>2020-10-02T23:59:00Z</discontinuity-time>
      </statistics>
    </interface>
    <interface>
      <name>eth3</name>
      <type>ia:ethernetCsmacd</type>
      <oper-status>up</oper-status>
      <statistics>
         <discontinuity-time>2020-10-02T23:59:00Z</discontinuity-time>
      </statistics>
    </interface>
    <interface>
      <name>eth4</name>
      <type>ia:ethernetCsmacd</type>
      <oper-status>up</oper-status>
      <statistics>
         <discontinuity-time>2020-10-02T23:59:00Z</discontinuity-time>
      </statistics>
    </interface>
  </interfaces>
<detnet
  xmlns="urn:ietf:params:xml:ns:yang:ietf-detnet">
  <app-flows>
    <app-flow>
      <name>app-1</name>
      <app-flow-bidir-congruent>false</app-flow-bidir-congruent>
      <outgoing-service>ssl-1</outgoing-service>
       <traffic-profile>1</traffic-profile>



Geng, et al.              Expires May 20, 2021                 [Page 46]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


      <ingress>
        <interface>eth0</interface>
        <src-ip-prefix>1.1.1.1/32</src-ip-prefix>
        <dest-ip-prefix>8.8.8.8/32</dest-ip-prefix>
      </ingress>
    </app-flow>
    <app-flow>
      <name>app-2</name>
      <app-flow-bidir-congruent>false</app-flow-bidir-congruent>
      <outgoing-service>ssl-2</outgoing-service>
       <traffic-profile>1</traffic-profile>
      <ingress>
        <interface>eth1</interface>
        <src-ip-prefix>1.1.1.2/32</src-ip-prefix>
        <dest-ip-prefix>8.8.8.9/32</dest-ip-prefix>
      </ingress>
    </app-flow>
  </app-flows>
  <traffic-profile>
    <profile-name>1</profile-name>
    <traffic-requirements>
      <min-bandwidth>100000000</min-bandwidth>
      <max-latency>100000000</max-latency>
      <max-latency-variation>200000000</max-latency-variation>
      <max-loss>2</max-loss>
      <max-consecutive-loss-tolerance>5</max-consecutive-loss-tolerance>
      <max-misordering>0</max-misordering>
    </traffic-requirements>
    <member-applications>app-1</member-applications>
    <member-applications>app-2</member-applications>
  </traffic-profile>
  <traffic-profile>
    <profile-name>2</profile-name>
    <traffic-requirements>
      <min-bandwidth>100000000</min-bandwidth>
      <max-latency>100000000</max-latency>
      <max-latency-variation>200000000</max-latency-variation>
      <max-loss>2</max-loss>
      <max-consecutive-loss-tolerance>5</max-consecutive-loss-tolerance>
      <max-misordering>0</max-misordering>
    </traffic-requirements>
    <member-services>ssl-1</member-services>
    <member-services>ssl-2</member-services>
  </traffic-profile>
  <traffic-profile>
    <profile-name>3</profile-name>
    <traffic-specification>
      <interval>5</interval>



Geng, et al.              Expires May 20, 2021                 [Page 47]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


      <max-packets-per-interval>10</max-packets-per-interval>
      <max-payload-size>1500</max-payload-size>
    </traffic-specification>
    <member-forwarding-sublayers>afl-1</member-forwarding-sublayers>
  </traffic-profile>
  <service-sub-layer>
    <service-sub-layer-list>
      <name>ssl-1</name>
      <service-rank>10</service-rank>
      <traffic-profile>2</traffic-profile>
      <service-operation-type>
        service-initiation
      </service-operation-type>
      <service-protection>
        <service-protection-type>none</service-protection-type>
        <sequence-number-length>long-sn</sequence-number-length>
      </service-protection>
     <incoming-type>
        <app-flow>
          <flow-list>app-1</flow-list>
        </app-flow>
      </incoming-type>
      <outgoing-type>
        <forwarding-sub-layer>
          <service-outgoing-list>
            <service-outgoing-index>0</service-outgoing-index>
            <mpls-label-stack>
              <entry>
                <id>0</id>
                <label>100</label>
              </entry>
            </mpls-label-stack>
            <next-layer>
              <index>0</index>
              <forwarding-sub-layer>afl-1</forwarding-sub-layer>
            </next-layer>
          </service-outgoing-list>
        </forwarding-sub-layer>
      </outgoing-type>
    </service-sub-layer-list>
    <service-sub-layer-list>
      <name>ssl-2</name>
      <service-rank>10</service-rank>
      <traffic-profile>2</traffic-profile>
      <service-operation-type>
        service-initiation
      </service-operation-type>
      <service-protection>



Geng, et al.              Expires May 20, 2021                 [Page 48]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


        <service-protection-type>none</service-protection-type>
        <sequence-number-length>long-sn</sequence-number-length>
      </service-protection>
     <incoming-type>
        <app-flow>
          <flow-list>app-2</flow-list>
        </app-flow>
      </incoming-type>
      <outgoing-type>
        <forwarding-sub-layer>
          <service-outgoing-list>
            <service-outgoing-index>0</service-outgoing-index>
            <mpls-label-stack>
              <entry>
                <id>0</id>
                <label>103</label>
              </entry>
            </mpls-label-stack>
            <next-layer>:
              <index>0</index>
              <forwarding-sub-layer>afl-1</forwarding-sub-layer>
            </next-layer>
          </service-outgoing-list>
        </forwarding-sub-layer>
      </outgoing-type>
    </service-sub-layer-list>
    </service-sub-layer>
    <forwarding-sub-layer>
    <forwarding-sub-layer-list>
      <name>afl-1</name>
      <traffic-profile>3</traffic-profile>
      <forwarding-operation-type>
        impose-and-forward
      </forwarding-operation-type>
      <incoming-type>
        <service-sub-layer>
          <sub-layer-list>ssl-1</sub-layer-list>
          <sub-layer-list>ssl-2</sub-layer-list>
        </service-sub-layer>
      </incoming-type>
      <outgoing-type>
        <interface>
          <outgoing-interface>eth2</outgoing-interface>
        </interface>
        <mpls-label-stack>
          <entry>
            <id>0</id>
            <label>10000</label>



Geng, et al.              Expires May 20, 2021                 [Page 49]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


          </entry>
        </mpls-label-stack>
      </outgoing-type>
    </forwarding-sub-layer-list>
    </forwarding-sub-layer>
</detnet>

                Figure 2: Example DetNet XML configuration

A.3.  Example JSON Service Aggregation Configuration

   {
     "ietf-interfaces:interfaces": {
       "interface": [
         {
           "name": "eth0",
           "type": "iana-if-type:ethernetCsmacd",
           "oper-status": "up",
           "statistics": {
             "discontinuity-time": "2020-10-02T23:59:00Z"
           }
         },
         {
           "name": "eth1",
           "type": "iana-if-type:ethernetCsmacd",
           "oper-status": "up",
           "statistics": {
             "discontinuity-time": "2020-10-02T23:59:00Z"
           }
         },
         {
           "name": "eth2",
           "type": "iana-if-type:ethernetCsmacd",
           "oper-status": "up",
           "statistics": {
             "discontinuity-time": "2020-10-02T23:59:00Z"
           }
         },
         {
           "name": "eth3",
           "type": "iana-if-type:ethernetCsmacd",
           "oper-status": "up",
           "statistics": {
             "discontinuity-time": "2020-10-02T23:59:00Z"
           }
         },
         {
           "name": "eth4",



Geng, et al.              Expires May 20, 2021                 [Page 50]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


           "type": "iana-if-type:ethernetCsmacd",
           "oper-status": "up",
           "statistics": {
             "discontinuity-time": "2020-10-02T23:59:00Z"
           }
         }
       ]
     },
     "ietf-detnet:detnet": {
       "app-flows": {
         "app-flow": [
           {
             "name": "app-1",
             "app-flow-bidir-congruent": false,
             "outgoing-service": "ssl-1",
             "traffic-profile": "1",
             "ingress": {
               "interface": "eth0",
               "src-ip-prefix": "1.1.1.1/32",
               "dest-ip-prefix": "8.8.8.8/32"
             }
           },
           {
             "name": "app-2",
             "app-flow-bidir-congruent": false,
             "outgoing-service": "ssl-2",
             "traffic-profile": "1",
             "ingress": {
               "interface": "eth1",
               "src-ip-prefix": "1.1.1.2/32",
               "dest-ip-prefix": "8.8.8.9/32"
             }
           }
         ]
       },
       "traffic-profile": [
         {
           "profile-name": "1",
           "traffic-requirements": {
             "min-bandwidth": "100000000",
             "max-latency": 100000000,
             "max-latency-variation": 200000000,
             "max-loss": 2,
             "max-consecutive-loss-tolerance": 5,
             "max-misordering": 0
           },
           "member-applications": [
             "app-1",



Geng, et al.              Expires May 20, 2021                 [Page 51]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


             "app-2"
           ]
         },
         {
           "profile-name": "2",
           "traffic-requirements": {
             "min-bandwidth": "100000000",
             "max-latency": 100000000,
             "max-latency-variation": 200000000,
             "max-loss": 2,
             "max-consecutive-loss-tolerance": 5,
             "max-misordering": 0
           },
           "member-services": [
             "ssl-1",
             "ssl-2"
           ]
         },
         {
           "profile-name": "3",
           "traffic-specification": {
             "interval": 5,
             "max-packets-per-interval": 10,
             "max-payload-size": 1500
           },
           "member-forwarding-sublayers": [
             "afl-1"
           ]
         }
       ],
       "service-sub-layer": {
         "service-sub-layer-list": [
           {
             "name": "ssl-1",
             "service-rank": 10,
             "traffic-profile": "2",
             "service-protection": {
               "service-protection-type": "none",
               "sequence-number-length": "long-sn"
             },
             "service-operation-type": "service-initiation",
             "incoming-type": {
               "app-flow": {
                 "flow-list": [
                   "app-1"
                 ]
               }
             },



Geng, et al.              Expires May 20, 2021                 [Page 52]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


             "outgoing-type": {
               "service-sub-layer": {
                 "aggregation-service-sub-layer": "asl-1",
                 "service-label": {
                   "mpls-label-stack": {
                     "entry": [
                       {
                         "id": 0,
                         "label": 102
                       }
                     ]
                   }
                 }
               }
             }
           },
           {
             "name": "ssl-2",
             "service-rank": 10,
             "traffic-profile": "2",
             "service-operation-type": "service-initiation",
             "service-protection": {
               "service-protection-type": "none",
               "sequence-number-length": "long-sn"
             },
             "incoming-type": {
               "app-flow": {
                 "flow-list": [
                   "app-2"
                 ]
               }
             },
             "outgoing-type": {
               "service-sub-layer": {
                 "aggregation-service-sub-layer": "asl-1",
                 "service-label": {
                   "mpls-label-stack": {
                     "entry": [
                       {
                         "id": 0,
                         "label": 105
                       }
                     ]
                   }
                 }
               }
             }
           },



Geng, et al.              Expires May 20, 2021                 [Page 53]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


           {
             "name": "asl-1",
             "service-rank": 10,
             "service-protection": {
               "service-protection-type": "none",
               "sequence-number-length": "long-sn"
             },
             "incoming-type": {
               "service": {
                 "service-sub-layer": [
                   "ssl-1",
                   "ssl-2"
                 ]
               }
             },
             "outgoing-type": {
               "forwarding-sub-layer": {
                 "service-outgoing-list": [
                   {
                     "service-outgoing-index": 0,
                     "mpls-label-stack": {
                       "entry": [
                         {
                           "id": 0,
                           "label": 1000
                         }
                       ]
                     },
                     "next-layer": [
                       {
                         "index": 0,
                         "forwarding-sub-layer": "afl-1"
                       }
                     ]
                   }
                 ]
               }
             }
           }
         ]
       },
       "forwarding-sub-layer": {
         "forwarding-sub-layer-list": [
           {
             "name": "afl-1",
             "traffic-profile": "3",
             "forwarding-operation-type": "impose-and-forward",
             "outgoing-type": {



Geng, et al.              Expires May 20, 2021                 [Page 54]

Internet-Draft          draft-ietf-detnet-yang-09          November 2020


               "interface": {
                 "outgoing-interface": "eth2"
               }
             }
           }
         ]
       }
     }
   }

             Figure 3: Example DetNet JSON Service Aggregation

Authors' Addresses

   Xuesong Geng
   Huawei Technologies

   Email: gengxuesong@huawei.com


   Mach(Guoyi) Chen
   Huawei Technologies

   Email: mach.chen@huawei.com


   Yeoncheol Ryoo
   ETRI

   Email: dbduscjf@etri.re.kr


   Don Fedyk
   LabN Consulting, L.L.C.

   Email: dfedyk@labn.net


   Reshad Rahman
   Individual

   Email: reshad@yahoo.com


   Zhenqiang Li
   China Mobile

   Email: lizhenqiang@chinamobile.com



Geng, et al.              Expires May 20, 2021                 [Page 55]
